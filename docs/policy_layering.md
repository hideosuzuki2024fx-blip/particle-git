# Policy Layering Guide (No-Duplication)

このドキュメントは、GPTの「パーソナライズ」と「リポジトリ内ルール（rules/・protocols/・docs/・meta/）」の重複を減らし、
矛盾や誤読を防ぐための運用指針です。

## Layers（役割分担）

### Layer 0: システム/チャット環境の制約
- ツール可否、実行環境、セキュリティ制約など（GPT側で変更不可）

### Layer 1: パーソナライズ（1500文字の最小コア）
- 常時適用の最小限だけを書く（例：推測禁止、URL提示時の取得試行、Raw URL、E:\前提）
- 詳細ルールはここに増やさない（増やすと制限に抵触しやすい）

### Layer 2: リポジトリ内の外部仕様（rules/・protocols/・docs/）
- 運用の詳細・出力プロトコル・安全設計はここに集約する
- MUST / MUST NOT / CONTEXT を基本単位にして、GPTが誤読しにくい形にする

### Layer 3: ポリシーの単一の情報源（meta/）
- 評価ルールやチェックリスト、意図カテゴリなどは `meta/` を単一の情報源とする

## Priority（優先順位の考え方）
- パーソナライズは「最小コア」なので、詳細判断はリポジトリ内仕様（Layer 2）を優先する
- ポリシー内容（評価ルールなど）の解釈は `meta/`（Layer 3）を優先する
- 参照できない場合は「参照できない」と明示し、推測しない

## Update Flow（更新手順）
1. まずリポジトリ内（Layer 2/3）を更新してレビュー可能にする
2. その後、必要ならパーソナライズ（Layer 1）を最小限だけ追従させる
3. `docs/sources_for_gpt.md` を更新し、参照経路を常に明確にする

## Anti-Patterns（避けること）
- 同じルールをパーソナライズと rules/ に二重に書く
- “一般論” で曖昧に補完して結論を作る
- 参照できていないのに、参照できた体で説明する

## Personalization Minimal Core
- docs/personalization_min_core.md / .txt をテンプレとして使い、パーソナライズは最小コアに固定する

